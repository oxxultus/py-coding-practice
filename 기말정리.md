# 3. 파일 입출력
---

## CSV 파일
- **encoding :** 윈도우 : cp949 / 맥, 리눅스 : utf-8


```python
import csv
```


```python
# CSV 파일 열기
f = open('reference files/csv/characters.csv', 'r', encoding='cp949')

# csv.reader를 사용하여 파일 읽기
rdr = csv.reader(f)

# 한 줄씩 읽어서 두 번째 열만 출력
for line in rdr:
    print(line[1])

next(data)  # 첫 번째 줄은 건너뜁니다.
    
# 파일 닫기
f.close()
```


```python
# CSV 파일을 쓰기 모드로 열기
# 'newline' 매개변수는 빈 줄을 자동으로 삽입하지 않도록 합니다.
f = open('reference files/csv/write.csv', 'w', encoding='cp949', newline='')

# csv.writer 객체 생성
wr = csv.writer(f)

# 각 행에 데이터 작성
# 첫 번째 행은 열의 이름
wr.writerow(['ID', '이름', '상징색', '취미', '특징'])

# 나머지 행은 실제 데이터
wr.writerow(['001', '뽀로로', '파랑색', '낚시', '펭귄'])

# 파일 닫기
f.close()
```


```python
# CSV 파일을 추가 모드로 열기
# 'newline' 매개변수는 빈 줄을 자동으로 삽입하지 않도록 합니다.
f = open('reference files/csv/write.csv', 'a', encoding='cp949', newline='')

# csv.writer 객체 생성
wr = csv.writer(f)

# 추가할 데이터를 행에 작성
wr.writerow(['006', '포비', '흰색', '춤', '북극곰'])

# 파일 닫기
f.close()
```

## 엑셀 파일

### **2. 파이썬으로 엑셀 파일 읽기**


```python
import openpyxl
```


```python
# Excel 파일을 열고 workbook 객체 생성
wb = openpyxl.load_workbook('reference files/xlsx/characters.xlsx')
```


```python
# 워크북에 포함된 시트의 이름을 출력
print(wb.sheetnames)
```


```python
# 'Sheet1' 시트를 선택하여 해당 시트의 A1 셀의 값을 출력
sheet1 = wb['Sheet1']  # 'Sheet1' 시트 선택
print(sheet1['A1'].value)  # A1 셀의 값 출력
```

### **3. 파이썬으로 엑셀 파일 작성하기**


```python
# 새로운 Excel 워크북을 생성합니다.
wb = openpyxl.Workbook()
```


```python
# Excel 워크북에 'Sheet2'라는 이름의 새 시트를 추가합니다.
wb.create_sheet('Sheet2')

# 변경된 시트 목록을 출력합니다.
print(wb.sheetnames)
```


```python
# 시트 이름을 할당하고 출력합니다
sheet1 = wb['Sheet']  # Sheet1을 '캐릭터 명단'으로 변경합니다
sheet2 = wb['Sheet2']  # Sheet2를 '인기도 조사'로 변경합니다

sheet1.title = '캐릭터 명단'  # Sheet1의 이름을 '캐릭터 명단'으로 변경합니다
sheet2.title = '인기도 조사'  # Sheet2의 이름을 '인기도 조사'로 변경합니다

print(wb.sheetnames)  # 업데이트된 시트 이름을 출력합니다
```


```python
sheet2['B1'] = '인기도 조사결과'  # Sheet2의 B1 셀에 '인기도 조사결과'를 할당합니다
print(sheet2['B1'].value)  # B1 셀의 값을 출력합니다
```


```python
copysheet = wb.copy_worksheet(sheet2)  # Sheet2를 복사하여 새 시트를 생성합니다
print(wb.sheetnames)  # 업데이트된 시트 이름을 출력합니다
```


```python
copysheet.title = 'copy'  # 복사된 시트의 이름을 'copy'로 변경합니다
print(wb.sheetnames)  # 업데이트된 시트 이름을 출력합니다
print(copysheet['B1'].value)  # 복사된 시트의 B1 셀의 값을 출력합니다
```


```python
del wb['인기도 조사']  # '인기도 조사' 시트를 삭제합니다
print(wb.sheetnames)  # 업데이트된 시트 이름을 출력합니다
```


```python
wb.save('reference files/xlsx/complete2.xlsx')  # 변경 사항을 포함한 워크북을 새 파일에 저장합니다
```

# 6. 넘파이 판다스
---

## 넘파이


```python
import numpy as npy
```


```python
# ndarray 생성 
npy = npy.arange(12).reshape(4, 3)
npy.array([[1, 2, 3], [4, 5, 6]], dtype=np.int8)
npy.zeros((4, 3))    # 요소값이 모두 0
npy.ones((4, 3))     # 요소값이 모두 1
npy.full((4, 3), 2)  # 요소값이 모두 2
npy.eye(3)           # 단위행렬
```


```python
# 배열 속성 및 연산
npy.size           # 요소개수
npy.dtype          # 데이터타입
npy.shape=(3, 8)   # 모양
npy.ndim           # 차원 수
npy.flat           # 이터레이터
npy.nbytes         # 바이트 크기
npy.T              # 전치행렬
```


```python
# 배열 변환
npy.astype(dtype)
npy.flatten()
npy.reshape((shape))
npy.resize((shape))
npy.transpose() # 전치행렬과 동일
```


```python
# 배열 요소 합과 평균
npy.sum()          # 전체요소의 합
npy.sum(axis=0 or 1)  # 특정 축(axis)을 기준으로 합을 계산
npy.mean()         # 전체요소의 평균
npy.mean(axis=0 or 1)  # 특정 축(axis)을 기준으로 평균을 계산
```


```python
np.random.seed(): 난수 생성의 시드를 설정하는 함수.

np.random.randn(): 표준 정규 분포를 따르는 난수 배열을 생성하는 함수.
# (3,4) 3행4열 과 같은 형식
# d0, d1, ..., dn (optional): 난수 배열의 차원 크기를 지정하는 매개변수. 
# 여러 개의 차원 크기를 지정하면 해당 크기의 다차원 배열을 생성합니다.

np.random.randint(): 지정된 범위에서 정수 난수를 생성하는 함수.
# low: 난수를 생성할 최소값을 지정합니다.
# high (optional): 난수를 생성할 최대값을 지정합니다. 이 값은 low 이상이어야 합니다.
# size (4,3): 생성할 난수 배열의 크기를 지정합니다.

np.random.rand(): 0에서 1 사이의 난수를 생성하는 함수.
# (3,4) 3행4열 과 같은 형식
# d0, d1, ..., dn (optional): 난수 배열의 차원 크기를 지정하는 매개변수. 
# 여러 개의 차원 크기를 지정하면 해당 크기의 다차원 배열을 생성합니다.

np.linspace(): 지정된 범위에서 일정 간격의 숫자 배열을 생성하는 함수.
# start: 배열의 시작 값.
# stop: 배열의 종료 값.
# num (optional): 배열에 포함될 숫자의 개수. 기본값은 50입니다.
# endpoint (optional): stop 값을 배열에 포함할지 여부를 지정합니다. 
# 기본값은 True로, stop 값이 배열의 마지막 숫자로 포함됩니다.

np.arange(): 지정된 범위에서 일정 간격의 숫자 배열을 생성하는 함수.
# start (optional): 배열의 시작 값. 지정하지 않으면 기본값은 0입니다.
# stop: 배열의 종료 값. 이 값은 배열에 포함되지 않습니다.
# step (optional): 배열의 간격을 지정합니다. 기본값은 1입니다.
```

## 판다스


```python
import pandas as pd
```


```python
# Pandas 시리즈 라이브러리 함수
pd.Series([리스트],index=[리스트]) 
pd.Series({딕셔너리}) #key => index, value=>value

pd_Series.unique() 고유값
pd_Series.count_values(sort=True or False) 고유값의 개수 , 오름차순 정렬할지 말지
pd_Series.rank(ascending=True or False,method='max' or 'min' or 'first')  
pd_Series[pd_Series.isin(['value'])] # 해당값만 출력 boolean

pd_Series = pd.Series([1, 2, 3, 4])
pd_Series = pd.Series([1, 2, 3], index=['a', 'b', 'c'])
pd_Series = pd.Series({'city': '서울', 'year': 2018})
pd_Series = pd.Series({'city': ['서울', '부산', '대전', '대구', '광주'],
         'year': [2017, 2017, 2018, 2018, 2018],
         'temp': [18, 20, 19, 21, 20]})
```


```python
# Pandas 데이터프레임 라이브러리 함수
pd.DataFrame({딕셔너리}) #키값이 열제목, 값이 해당열의 value로 들어간다
pd.DataFrame([리스트])  
#([리스트],[인덱스],[열제목]) => 1열으로 생성
#([[리스트],[리스트2],[리스트3]])=> ('리스트의 개수'행 생성) * ('리스트의 요소 개수' 열으로 생성)
pd.DataFrame(np.arange(12).reshape(4,3),columns=[리스트],index=[리스트])

시리즈 = 데이터프레임['column'] # 하나의 열은 시리즈
데이터프레임 = 데이터프레임[['column','column']] # 두개 이상의 열은 데이터프레임

pd_DataFrame.index = [리스트]
pd_DataFrame.columns = [리스트]
pd_DataFrame.loc[index_number, 'columns']
pd_DataFrame.iloc[index_number] 
pd_DataFrame.set_index('column',inplace=True or False)
pd_DataFrame.fillna(value)  # 결측값 value값으로 바꾸기
pd_DataFrame['key'] = value # value의 값을 가진 key라는 열을 추가 하거나 있으면 변경한다.
pd_DataFrame.describe()     # 데이터프레임의 요약 통계 정보를 출력합니다
pd_DataFrame.info()         # 데이터프레임의 각 열에 대한 정보를 출력합니다
pd_DataFrame.ffill()        # 누락된 값을 앞 방향으로 채웁니다.
pd_DataFrame.head(n=5)
pd_DataFrame.tail(n=5)
pd_DataFrame.rename(columns={'최저기온(°C)': 'min_temp'}, inplace=True) # 열 이름을 변경합니다
pd_DataFrame.div(other, axis='(0)index'or'(1)columns', level=None, fill_value=None)
pd_DataFrame.date_range('1/1/2000', periods=8) # '1/1/2000'부터 시작하여 8일간의 날짜를 포함하는 날짜 범위를 생성합니다.
pd_DataFrame.datetime(pd_DataFrame['columns'], format='%Y-%m-%d') # 2022-01-01 형식

#기준으로 연산
pd_DataFrame.drop(index or key,axis=0 or 1,inplace=True or False)
pd_DataFrame.dropna(axis=0 or 1,inplace=True or False)

#방향으로 연산
pd_DataFrame.sort_index(axis 0 or 1, ascending=True or False,inplace=True or False)
pd_DataFrame.sort_values(by=['b', 'c'],ascending=True or False,inplace=True or False)
pd_DataFrame.rank(axis=0 or 1,ascending=True or False,method='first','max','min')
pd_DataFrame.sum(axis=0 or 1,skipna=True or False)
pd_DataFrame.mean(axis=0 or 1,skipna=True or False)
pd_DataFrame.idxmax(axis=0 or 1)
pd_DataFrame.idxmin(axis=0 or 1)

# 조건에 따라 새로운 열 'high1'을 DataFrame '데이터프레임'에 추가합니다.
# car의 값보다 크거나 같으면 True를 작으면 False를 저장한다.
pd_DataFrame['high1'] = pd_DataFrame.car >= 30

# 시리즈를 CSV 파일로 저장합니다.
# './file2.csv'는 저장할 파일의 경로와 이름을 나타냅니다.
# header=True는 열 이름을 포함하여 저장하고, index=False는 인덱스를 저장하지 않습니다.
# encoding='utf-8'은 UTF-8 인코딩을 사용하여 파일을 저장합니다.
pd_DataFrame.to_csv('./file2.csv', header=True, index=False, encoding='utf-8')

# CSV 파일을 읽어서 데이터프레임으로 변환합니다.
# './file2.csv'에서 파일을 읽어오며, sep=','는 구분자로 쉼표를 사용합니다.
pd_DataFrame = pd.read_csv('./file2.csv', sep=',')
```

# 7. 데이터 시각화
---

## 1. matplotlib


```python
import matplotlib.pyplot as plt
```


```python
str.contains(name) # name이라는 문자열을 찾음
round(number, 소수점이하자릿수) # 소수점 이하 자릿수까지 반올림
map(int, row[4:]) # 4번째 열부터 끝까지를 정수로 변환합니다.
```


```python
# '-' 부호가 제대로 표시되게 하는 설정 
matplotlib.rcParams['axes.unicode_minus'] = False
```


```python
# 'reference files/csv/age2.csv' 파일을 cp949 인코딩으로 읽어와서 DataFrame으로 저장합니다.
# 첫 번째 열을 인덱스로 지정합니다.
df = pd.read_csv('reference files/csv/age2.csv', encoding='cp949', index_col=0)
```


```python
# plot 그래프 그리기
plt.figure(figsize=(5, 3), dpi=300)  # 그래프의 크기를 5인치 x 3인치로 설정하고, 해상도를 300dpi로 설정합니다.
plt.subplot(row, column, index)

plt.title('')  # 그래프 제목 설정
plt.style.use('default')  # ggplot, classic, Solarize_Light2

plt.plot(range(1, 32), df_Mar['max_temp'], label='최고기온', c='r')  # 최고기온 그래프
plt.plot(range(max(m)), range(max(m)), 'g') # 대각선 직선을 그립니다. (x=y)
plt.plot(high, 'hotpink')  # 최고 기온을 hotpink 색으로 그립니다
plt.plot(low, 'skyblue')  # 최저 기온을 skyblue 색으로 그립니다

plt.xlabel('')  # x축 레이블 설정
plt.ylabel('')  # y축 레이블 설정

plt.xlim(1, 31)  # x축 범위 설정
plt.ylim(-7, 22)  # y축 범위 설정

plt.xticks(range(24), label = mx_station, rotation=90, size=6)  # x축 눈금을 시간대와 역 이름으로 설정하고, 90도 회전시킵니다.
plt.yticks(range(24), label = mx_station, rotation=90, size=6)  # y축 눈금을 시간대와 역 이름으로 설정하고, 90도 회전시킵니다.

plt.legend()  # 범례 표시

plt.axis('equal') # off, on, scaled
plt.tight_layout()  # 그래프 요소들이 겹치지 않도록 설정합니다.
plt.savefig('./서울.png')  # 그래프를 이미지 파일로 저장합니다
plt.show()  # 그래프 출력
```


```python
# 막대 그래프
# 범위 0부터 100까지의 값을 x축으로 하고, result 리스트의 값들을 y축으로 하여 막대 그래프를 그립니다.
plt.bar(x, y, color='',width=,) # (range(101), result)
```


```python
# 수평 막대 그래프
# 범위 0부터 100까지의 값을 y축으로 하고, result 리스트의 값들을 x축으로 하여 가로 막대 그래프를 그립니다.
plt.barh(y, x, color='',height=,) # (range(101), result)
```


```python
# 히스토그램
plt.hist(aug, bins=100, color='r', label='Aug')  # bins=가로축 개수, 구간의 개수 8월 기온에 대한 히스토그램을 그립니다
plt.hist(jan, bins=100, color='b', alpha=0.5, label='Jan')  # 1월 기온에 대한 히스토그램을 그립니다 (alpha값 설정으로 투명도 조절)
```


```python
# 박스 플롯 
plt.boxplot(day, showfliers=False)  # 상자그림을 그립니다 (이상치(showfliers)는 표시하지 않습니다)
```


```python
# 원형 그래프를 그립니다.
# 데이터는 size 리스트, 레이블은 ['남', '여'], 백분율 표시, 색상은 color 리스트, 시작 각도는 90도입니다.
plt.pie(size, labels=['남', '여'], autopct='%.1f%%', colors=['crimson', 'darkcyan'], startangle=90)
```


```python
# 산점도 
plt.scatter(x, y,s=makersize,c=color)
```

## 2. 위키피디아


```python
# 위키피디아에서 올림픽 메달 테이블을 포함한 HTML 페이지를 가져와서 DataFrame으로 변환합니다.
# header=0은 첫 번째 행을 열 이름으로 지정하고, index_col=0은 첫 번째 열을 행 인덱스로 지정합니다.
df = pd.read_html('https://en.wikipedia.org/wiki/All-time_Olympic_Games_medal_table', header=0, index_col=0)
```


```python
# summer에는 df[1]의 모든 행과 처음 다섯 개의 열의 데이터가 포함된 DataFrame 객체가 저장됩니다.
summer = df[1].iloc[:, :5]
```


```python
# DataFrame 객체 summer을 엑셀 파일로 저장합니다.
# 'reference files/xlsx/' 경로에 '하계올림픽메달.xlsx' 파일로 저장됩니다.
summer.to_excel('reference files/xlsx/하계올림픽메달.xlsx')
```

# 8. 데이터 전처리
---


```python
# 이전행의 값과 같게 채운다
fillna(method = ffill)
```
